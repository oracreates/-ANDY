<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallet Pixel Art</title>
<style>
  body { font-family: sans-serif; text-align: center; margin-top: 50px; }
  #canvas { border: 2px solid #333; margin-top: 20px; }
  button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
</style>
</head>
<body>
<h1>Wallet Pixel NFT Art</h1>
<button id="connectWallet">Connect Solflare Wallet</button>
<canvas id="canvas" width="200" height="200"></canvas>

<script type="module">
// Import Solflare adapter if hosted via npm or CDN
import { SolflareWallet } from "https://cdn.jsdelivr.net/npm/@solflare-wallet/adapter/dist/solflare.js";

// Canvas setup
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

// Connect wallet
const walletButton = document.getElementById("connectWallet");
let walletAddress = "";

walletButton.addEventListener("click", async () => {
    const wallet = new SolflareWallet();
    await wallet.connect();
    walletAddress = wallet.publicKey.toString();
    alert("Connected wallet: " + walletAddress);
    generatePixelArt(walletAddress);
});

// Simple deterministic hash function from string
function hashStringToNumbers(str, max) {
    const hash = Array.from(str).reduce((acc, char) => acc + char.charCodeAt(0), 0);
    return Array.from(str).map(c => c.charCodeAt(0) % max);
}

// Generate pixel art
function generatePixelArt(walletAddr) {
    const size = 8; // 8x8 grid
    const pixelSize = canvas.width / size;

    const numbers = hashStringToNumbers(walletAddr, 255);

    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw pixels
    for (let y = 0; y < size; y++) {
        for (let x = 0; x < size; x++) {
            const n = numbers[(x + y) % numbers.length];
            ctx.fillStyle = `rgb(${n}, ${255 - n}, ${n * 2 % 255})`;
            ctx.fillRect(x * pixelSize, y * pixelSize, pixelSize, pixelSize);
        }
    }
}

</script>
</body>
</html>